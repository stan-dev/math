<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stan Math Library: Kernel Executor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="standoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<script type="text/javascript" src="eigen_navtree_hacks.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="stanlogo-main.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://mc-stan.org/math">Stan Math Library</a>
   &#160;<span id="projectnumber">5.0.0</span>
   </div>
   <div id="projectbrief">Automatic Differentiation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__kernel__executor__opencl.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Kernel Executor<div class="ingroups"><a class="el" href="group__opencl.html">OpenCL</a></div></div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The kernel executor allows OpenCL kernels to be executed in async. </p>
<p>GPUs have the capability to perform reads, writes, and computation at the same time. In order to maximize the throughput to the device the Kernel Executor assigns matrices read and write events. Write events are blocking in that no further operations can be completed until the write event is finished. However, read events can happen in async together. Take the following for example</p>
<div class="fragment"><div class="line">matrix_cl&lt;double&gt; A = from_eigen_cl(A_eig);</div>
<div class="line">matrix_cl&lt;double&gt; B = from_eigen_cl(B_eig);</div>
<div class="line">matrix_cl&lt;double&gt; C = A * B;</div>
<div class="line">matrix_cl&lt;double&gt; D = A + B;</div>
<div class="line">matrix_cl&lt;double&gt; E = C + D;</div>
</div><!-- fragment --><p> In the above, When <code>A</code> and <code>B</code> are created from the <a class="el" href="namespace_eigen.html" title="(Expert) Numerical traits for algorithmic differentiation variables.">Eigen</a> matrices <code>A_eig</code> and <code>B_eig</code>. they are both assigned write events to their write event stack. <code>C</code> and <code>D</code> depend on <code>A</code> and <code>B</code> while <code>E</code> depends on <code>C</code> and <code>D</code>. When executing <code>C</code>'s operation, <code>A</code> and <code>B</code> are assigned events to their read event stack while <code>C</code> is assigned an event to it's write event stack. Once <code>A</code> and <code>B</code> have finished their write event the kernel to compute <code>C</code> can begin. The excution to create <code>D</code> also waits for the write events of <code>A</code> and <code>B</code>, but does not have to wait for the execution of <code>C</code> to finish. Executing <code>E</code> requires waiting for for the write events of both <code>C</code> and <code>D</code>. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1opencl__kernels_1_1in__buffer.html">stan::math::opencl_kernels::in_buffer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An <a class="el" href="structstan_1_1math_1_1opencl__kernels_1_1in__buffer.html" title="An in_buffer signifies a cl::Buffer argument used as input.">in_buffer</a> signifies a cl::Buffer argument used as input.  <a href="structstan_1_1math_1_1opencl__kernels_1_1in__buffer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1opencl__kernels_1_1out__buffer.html">stan::math::opencl_kernels::out_buffer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An <a class="el" href="structstan_1_1math_1_1opencl__kernels_1_1out__buffer.html" title="An out_buffer signifies a cl::Buffer argument used as output.">out_buffer</a> signifies a cl::Buffer argument used as output.  <a href="structstan_1_1math_1_1opencl__kernels_1_1out__buffer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1opencl__kernels_1_1in__out__buffer.html">stan::math::opencl_kernels::in_out_buffer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An <a class="el" href="structstan_1_1math_1_1opencl__kernels_1_1in__out__buffer.html" title="An in_out_buffer signifies a cl::Buffer argument used as both input and output.">in_out_buffer</a> signifies a cl::Buffer argument used as both input and output.  <a href="structstan_1_1math_1_1opencl__kernels_1_1in__out__buffer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1opencl__kernels_1_1kernel__cl.html">stan::math::opencl_kernels::kernel_cl&lt; Args &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates functor for kernels.  <a href="structstan_1_1math_1_1opencl__kernels_1_1kernel__cl.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaba4b4295eb0b9e30bdcdbccf84660a2a"><td class="memTemplParams" colspan="2">template&lt;typename T , <a class="el" href="group__matrix__cl__types_ga1af53d2ea2874ab39e60e796c8f2c074.html#ga1af53d2ea2874ab39e60e796c8f2c074">require_not_matrix_cl_t</a>&lt; T &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:gaba4b4295eb0b9e30bdcdbccf84660a2a"><td class="memTemplItemLeft" align="right" valign="top">const T &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_gaba4b4295eb0b9e30bdcdbccf84660a2a.html#gaba4b4295eb0b9e30bdcdbccf84660a2a">stan::math::opencl_kernels::internal::get_kernel_args</a> (const T &amp;t)</td></tr>
<tr class="memdesc:gaba4b4295eb0b9e30bdcdbccf84660a2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts the kernel's arguments, used in the global and local kernel constructor.  <br /></td></tr>
<tr class="separator:gaba4b4295eb0b9e30bdcdbccf84660a2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2897d1fa163421d86914905a93dcee9"><td class="memTemplParams" colspan="2">template&lt;typename K , <a class="el" href="group__matrix__cl__types_gaf18202a28f3c86c16368f08c04f6532d.html#gaf18202a28f3c86c16368f08c04f6532d">require_matrix_cl_t</a>&lt; K &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:gad2897d1fa163421d86914905a93dcee9"><td class="memTemplItemLeft" align="right" valign="top">const cl::Buffer &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_gad2897d1fa163421d86914905a93dcee9.html#gad2897d1fa163421d86914905a93dcee9">stan::math::opencl_kernels::internal::get_kernel_args</a> (const K &amp;m)</td></tr>
<tr class="memdesc:gad2897d1fa163421d86914905a93dcee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts the kernel's arguments, used in the global and local kernel constructor.  <br /></td></tr>
<tr class="separator:gad2897d1fa163421d86914905a93dcee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69d3eac49b859fa73316f720f8c20884"><td class="memTemplParams" colspan="2">template&lt;typename T , <a class="el" href="group__matrix__cl__types_ga1af53d2ea2874ab39e60e796c8f2c074.html#ga1af53d2ea2874ab39e60e796c8f2c074">require_not_matrix_cl_t</a>&lt; T &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:ga69d3eac49b859fa73316f720f8c20884"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_ga69d3eac49b859fa73316f720f8c20884.html#ga69d3eac49b859fa73316f720f8c20884">stan::math::opencl_kernels::internal::assign_event</a> (const cl::Event &amp;<a class="el" href="namespacestan_1_1math_a3a7127a28f51e5042f0bc4301409dd2f.html#a3a7127a28f51e5042f0bc4301409dd2f">e</a>, const T &amp;)</td></tr>
<tr class="memdesc:ga69d3eac49b859fa73316f720f8c20884"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns the event to a <code><a class="el" href="classstan_1_1math_1_1matrix__cl.html" title="Represents an arithmetic matrix on the OpenCL device.">matrix_cl</a></code>.  <br /></td></tr>
<tr class="separator:ga69d3eac49b859fa73316f720f8c20884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab77d2bced7523577868c95c209125856"><td class="memTemplParams" colspan="2">template&lt;typename T , <a class="el" href="group__same__types_ga29595127b6ba2b597e5723c80dee1b61.html#ga29595127b6ba2b597e5723c80dee1b61">require_same_t</a>&lt; T, cl::Event &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:gab77d2bced7523577868c95c209125856"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_gab77d2bced7523577868c95c209125856.html#gab77d2bced7523577868c95c209125856">stan::math::opencl_kernels::internal::assign_events</a> (const T &amp;)</td></tr>
<tr class="memdesc:gab77d2bced7523577868c95c209125856"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the event to any <code>matrix_cls</code> in the arguments depending on whether they are <code><a class="el" href="structstan_1_1math_1_1opencl__kernels_1_1in__buffer.html" title="An in_buffer signifies a cl::Buffer argument used as input.">in_buffer</a></code>, <code><a class="el" href="structstan_1_1math_1_1opencl__kernels_1_1out__buffer.html" title="An out_buffer signifies a cl::Buffer argument used as output.">out_buffer</a></code>, or <code>in_out_buffers</code>.  <br /></td></tr>
<tr class="separator:gab77d2bced7523577868c95c209125856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb3309546732607c67fcc974054b044d"><td class="memTemplParams" colspan="2">template&lt;typename T , <a class="el" href="group__matrix__cl__types_ga1af53d2ea2874ab39e60e796c8f2c074.html#ga1af53d2ea2874ab39e60e796c8f2c074">require_not_matrix_cl_t</a>&lt; T &gt; *  = nullptr&gt; </td></tr>
<tr class="memitem:gabb3309546732607c67fcc974054b044d"><td class="memTemplItemLeft" align="right" valign="top">tbb::concurrent_vector&lt; cl::Event &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_gabb3309546732607c67fcc974054b044d.html#gabb3309546732607c67fcc974054b044d">stan::math::opencl_kernels::internal::select_events</a> (const T &amp;m)</td></tr>
<tr class="memdesc:gabb3309546732607c67fcc974054b044d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select events from kernel arguments.  <br /></td></tr>
<tr class="separator:gabb3309546732607c67fcc974054b044d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaceb2dfe5b656f305e484f5992404d441"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_gaceb2dfe5b656f305e484f5992404d441.html#gaceb2dfe5b656f305e484f5992404d441">stan::math::opencl_kernels::compile_kernel</a> (const char *name, const std::vector&lt; std::string &gt; &amp;sources, const std::unordered_map&lt; std::string, int &gt; &amp;options)</td></tr>
<tr class="memdesc:gaceb2dfe5b656f305e484f5992404d441"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compile an OpenCL kernel.  <br /></td></tr>
<tr class="separator:gaceb2dfe5b656f305e484f5992404d441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga12e55924d120807448b3dc0a483c8feb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_ga12e55924d120807448b3dc0a483c8feb.html#ga12e55924d120807448b3dc0a483c8feb">stan::math::opencl_kernels::kernel_cl&lt; Args &gt;::kernel_cl</a> (const char *name, std::vector&lt; std::string &gt; sources, std::unordered_map&lt; std::string, int &gt; options={})</td></tr>
<tr class="memdesc:ga12e55924d120807448b3dc0a483c8feb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates functor for kernels that only need access to defining the global work size.  <br /></td></tr>
<tr class="separator:ga12e55924d120807448b3dc0a483c8feb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2edcdc94a69739fd1cfab26c457262eb"><td class="memTemplParams" colspan="2">template&lt;typename... CallArgs&gt; </td></tr>
<tr class="memitem:ga2edcdc94a69739fd1cfab26c457262eb"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_ga2edcdc94a69739fd1cfab26c457262eb.html#ga2edcdc94a69739fd1cfab26c457262eb">stan::math::opencl_kernels::kernel_cl&lt; Args &gt;::operator()</a> (cl::NDRange global_thread_size, CallArgs &amp;&amp;... args) const</td></tr>
<tr class="memdesc:ga2edcdc94a69739fd1cfab26c457262eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes a kernel.  <br /></td></tr>
<tr class="separator:ga2edcdc94a69739fd1cfab26c457262eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga012ee6c8af99cf40c5df26e591ae9a03"><td class="memTemplParams" colspan="2">template&lt;typename... CallArgs&gt; </td></tr>
<tr class="memitem:ga012ee6c8af99cf40c5df26e591ae9a03"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_ga012ee6c8af99cf40c5df26e591ae9a03.html#ga012ee6c8af99cf40c5df26e591ae9a03">stan::math::opencl_kernels::kernel_cl&lt; Args &gt;::operator()</a> (cl::NDRange global_thread_size, cl::NDRange thread_block_size, CallArgs &amp;&amp;... args) const</td></tr>
<tr class="memdesc:ga012ee6c8af99cf40c5df26e591ae9a03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes a kernel.  <br /></td></tr>
<tr class="separator:ga012ee6c8af99cf40c5df26e591ae9a03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab6585fe09d1feeca2af78de1527c1ab3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__kernel__executor__opencl_gab6585fe09d1feeca2af78de1527c1ab3.html#gab6585fe09d1feeca2af78de1527c1ab3">stan::math::opencl_kernels::kernel_cl&lt; Args &gt;::get_option</a> (const std::string option_name) const</td></tr>
<tr class="memdesc:gab6585fe09d1feeca2af78de1527c1ab3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves an option used for compiling the kernel.  <br /></td></tr>
<tr class="separator:gab6585fe09d1feeca2af78de1527c1ab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
    <div class="contents" style="font-size:100%;">
      <span style="float:left; margin=0 1em 0 1em;">
      &nbsp;&nbsp;&nbsp;&nbsp;
      [ <a href="http://mc-stan.org/">Stan Home Page</a> ]
      </span>
      <span style="float:right; margin=0 1em 0 1em;">
      <i>&copy; 2011&ndash;2019,
      Stan Development Team.
      &nbsp;&nbsp;&nbsp;&nbsp;
      </i>
      </span>
    </div> </li>
  </ul>
</div>
</body>
</html>
