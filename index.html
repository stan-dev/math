<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stan Math Library: Stan Math Library Docs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="standoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<script type="text/javascript" src="eigen_navtree_hacks.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="stanlogo-main.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://mc-stan.org/math">Stan Math Library</a>
   &#160;<span id="projectnumber">5.0.0</span>
   </div>
   <div id="projectbrief">Automatic Differentiation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Stan Math Library Docs </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doxygen_2_r_e_a_d_m_e"></a> The <b>Stan Math Library</b> is a BSD-3 licensed C++, reverse-mode automatic differentiation library designed to facilitate the construction and utilization of algorithms that utilize derivatives.</p>
<h1><a class="anchor" id="autotoc_md141"></a>
Required Libraries</h1>
<p>Stan Math depends on four libraries:</p>
<ul>
<li>Boost (version 1.81.0): <a href="https://www.boost.org">Boost Home Page</a></li>
<li><a class="el" href="namespace_eigen.html" title="(Expert) Numerical traits for algorithmic differentiation variables.">Eigen</a> (version 3.3.9: <a href="https://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen Home Page</a></li>
<li>SUNDIALS (version 6.1.1): <a href="https://computing.llnl.gov/projects/sundials">Sundials Home Page</a></li>
<li>Intel TBB (version 2020.3): <a href="https://www.threadingbuildingblocks.org">Intel TBB Home Page</a></li>
</ul>
<p>These are distributed under the <code>lib/</code> subdirectory. Only these versions of the dependent libraries have been tested with Stan Math.</p>
<h1><a class="anchor" id="autotoc_md142"></a>
Contributing</h1>
<p>We love contributions from everyone in the form of good discussions, issues, and pull requests. If you are interested in contributing to Stan Math please check the Contributor Guide at <a href="https://mc-stan.org/math/">mc-stan.org/math</a>.</p>
<h1><a class="anchor" id="autotoc_md143"></a>
Installation</h1>
<p>The Stan Math Library is a C++ library which depends on the Intel TBB library and requires the Sundials library for ordinary differential equations and root solving. The build system is the make facility, which is used to manage all dependencies.</p>
<p>A simple hello world program using Stan Math is as follows:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="math_8hpp.html">stan/math.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;log normal(1 | 2, 3)=&quot;</span></div>
<div class="line">            &lt;&lt; <a class="code hl_function" href="group__opencl_gaad305d01ff13ab2f04921def01f434ff.html#gaad305d01ff13ab2f04921def01f434ff">stan::math::normal_lpdf</a>(1, 2, 3)</div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__opencl_gaad305d01ff13ab2f04921def01f434ff_html_gaad305d01ff13ab2f04921def01f434ff"><div class="ttname"><a href="group__opencl_gaad305d01ff13ab2f04921def01f434ff.html#gaad305d01ff13ab2f04921def01f434ff">stan::math::normal_lpdf</a></div><div class="ttdeci">return_type_t&lt; T_y_cl, T_loc_cl, T_scale_cl &gt; normal_lpdf(const T_y_cl &amp;y, const T_loc_cl &amp;mu, const T_scale_cl &amp;sigma)</div><div class="ttdoc">The log of the normal density for the specified scalar(s) given the specified mean(s) and deviation(s...</div><div class="ttdef"><b>Definition</b> <a href="opencl_2prim_2normal__lpdf_8hpp_source.html#l00040">normal_lpdf.hpp:40</a></div></div>
<div class="ttc" id="amath_8hpp_html"><div class="ttname"><a href="math_8hpp.html">math.hpp</a></div></div>
</div><!-- fragment --><p>If this is in the file <code>&lt;path&gt;/foo.cpp</code>, then you can compile and run this with something like this with <code>&lt;path&gt;</code> replaced with the path to the file:</p>
<div class="fragment"><div class="line">cd &lt;path&gt;/foo</div>
<div class="line">make -j4 -f &lt;path&gt;/stan-math/make/standalone math-libs</div>
<div class="line">make -f &lt;path&gt;/stan-math/make/standalone foo</div>
<div class="line">./foo</div>
<div class="line">log normal(1 | 2, 3)=-2.07311</div>
</div><!-- fragment --><p>The first make command with the <code>math-libs</code> target ensures that all binary dependencies of Stan Math are built and ready to use. The <code>-j4</code> instructs <code>make</code> to use 4 cores concurrently, which should be adapted to your needs. The second <code>make</code> command ensures that the Stan Math sources and all dependencies are available to the compiler when building <code>foo</code>.</p>
<p>An example of a real instantiation whenever the path to Stan Math is <code>~/stan-dev/math/</code>:</p>
<div class="fragment"><div class="line">&gt; make -j4 -f ~/stan-dev/math/make/standalone math-libs</div>
<div class="line">&gt; make -f ~/stan-dev/math/make/standalone foo</div>
</div><!-- fragment --><p> The <code>math-libs</code> target has to be called only once, and can be omitted for subsequent compilations.</p>
<p>The standalone makefile ensures that all the required <code>-I</code> include statements are given to the compiler, and the necessary libraries are linked: <code>~/stan-dev/math</code> and <code>~/stan-dev/math/lib/eigen_3.3.9</code> and <code>~/stan-dev/math/lib/boost_1.81.0</code> and <code>~/stan-dev/math/lib/sundials_6.1.1/include</code> and <code>~/stan-dev/math/lib/tbb_2020.3/include</code>. The <code>~/stan-dev/math/lib/tbb</code> directory is created by the <code>math-libs</code> makefile target automatically and contains the dynamically loaded Intel TBB library. The flags <code>-Wl,-rpath,...</code> instruct the linker to hard-code the path to the dynamically loaded Intel TBB library inside the stan-math directory into the final binary. This way the Intel TBB is found when executing the program.</p>
<p>Note for Windows users: On Windows the <code>-rpath</code> feature as used by Stan Math to hardcode an absolute path to a dynamically loaded library does not work. On Windows, the Intel TBB dynamic library <code>tbb.dll</code> is located in the <code>math/lib/tbb</code> directory. The user can choose to copy this file to the same directory of the executable or to add the directory <code>/path/to/math/lib/tbb</code> as an absolute path to the system-wide <code>PATH</code> variable.</p>
<h1><a class="anchor" id="autotoc_md144"></a>
Intel TBB</h1>
<p><code>math</code> supports the new interface of Intel TBB, can be configured to use an external copy of TBB (e.g., with <a href="https://github.com/oneapi-src/oneTBB"><code>oneTBB</code></a> or the system TBB library), using the <code>TBB_LIB</code> and <code>TBB_INC</code> environment variables.</p>
<p>To build the development version of <code>math</code> with <a href="https://github.com/oneapi-src/oneTBB"><code>oneTBB</code></a>:</p>
<ul>
<li>Install <a href="https://github.com/oneapi-src/oneTBB"><code>oneTBB</code></a>.</li>
</ul>
<p>For example, installing <a href="https://github.com/oneapi-src/oneTBB"><code>oneTBB</code></a> on Linux 64-bit (<code>x86_64</code>) to <code>$HOME</code> directory (change if needed!): </p><div class="fragment"><div class="line">TBB_RELEASE=&quot;https://api.github.com/repos/oneapi-src/oneTBB/releases/latest&quot;</div>
<div class="line">TBB_TAG=$(curl --silent $TBB_RELEASE | grep -Po &#39;&quot;tag_name&quot;: &quot;\K.*?(?=&quot;)&#39;)</div>
<div class="line">TBB_VERSION=${TBB_TAG#?}</div>
<div class="line"> </div>
<div class="line">wget https://github.com/oneapi-src/oneTBB/releases/download/v${TBB_VERSION}/oneapi-tbb-${TBB_VERSION}-lin.tgz</div>
<div class="line">tar zxvf oneapi-tbb-$TBB_VERSION-lin.tgz -C $HOME</div>
<div class="line"> </div>
<div class="line">export TBB=&quot;$HOME/oneapi-tbb-$TBB_VERSION&quot;</div>
</div><!-- fragment --><p> Note that you may replace <code>TBB_VERSION=${TBB_TAG#?}</code> with a custom version number if needed ( check available releases <a href="https://github.com/oneapi-src/oneTBB/releases">here</a> ).</p>
<ul>
<li>Set the TBB environment variables (specifically: <code>TBB</code> for the installation prefix, <code>TBB_INC</code> for the directory that includes the header files, and <code>TBB_LIB</code> for the libraries directory).</li>
</ul>
<p>For example, installing <a href="https://github.com/oneapi-src/oneTBB"><code>oneTBB</code></a> on Linux 64-bit (<code>x86_64</code>) to <code>$HOME</code> directory (change if needed!): </p><div class="fragment"><div class="line">source $TBB/env/vars.sh intel64</div>
<div class="line"> </div>
<div class="line">export TBB_INC=&quot;$TBB/include&quot;</div>
<div class="line">export TBB_LIB=&quot;$TBB/lib/intel64/gcc4.8&quot;</div>
</div><!-- fragment --><ul>
<li>Set <code>Stan</code> local compiler flags to use the new TBB interface: <div class="fragment"><div class="line">echo TBB_INTERFACE_NEW=true&gt;&gt; ./make/local</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="autotoc_md145"></a>
Compilers</h1>
<p>The above example will use the default compiler of the system as determined by <code>make</code>. On Linux this is usually <code>g++</code> while on MacOS it is typically <code>clang++</code>. On Windows, if the recommended RTools for Windows are used, it is <code>g++</code> as well. There's nothing special about any of these, and they can be changed through the <code>CXX</code> variable of <code>make</code>. The recommended way to set this variable for the Stan Math library is by creating a <code>make/local</code> file within the Stan Math library directory. Defining <code>CXX=g++</code> in this file will ensure that the GNU C++ compiler is always used, for example. The compiler must be able to fully support C++11 and partially the C++14 standard. The <code>g++</code> 4.9.3 version part of RTools for Windows currently defines the minimal C++ feature set required by the Stan Math library.</p>
<p>Note that whenever the compiler is changed, the user usually must clean and rebuild all binary dependencies with the commands: </p><div class="fragment"><div class="line">&gt; make -f path/to/stan-math/make/standalone math-clean</div>
<div class="line">&gt; make -j4 -f path/to/stan-math/make/standalone math-libs</div>
</div><!-- fragment --><p> This ensures that the binary dependencies are created with the new compiler.</p>
<h1><a class="anchor" id="autotoc_md146"></a>
Licensing</h1>
<p>The Stan Math Library is licensed under the <a href="https://github.com/stan-dev/math/blob/develop/LICENSE%2Emd">new BSD license</a>.</p>
<p>The Stan Math Library depends on the Intel TBB library which is licensed under the Apache 2.0 license. This dependency implies an additional restriction as compared to the new BSD license alone. The Apache 2.0 license is incompatible with GPL-2 licensed code if distributed as a unitary binary. You may refer to the Licensing page on the <a href="https://github.com/stan-dev/stan/wiki/Stan-Licensing">Stan wiki</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
    <div class="contents" style="font-size:100%;">
      <span style="float:left; margin=0 1em 0 1em;">
      &nbsp;&nbsp;&nbsp;&nbsp;
      [ <a href="http://mc-stan.org/">Stan Home Page</a> ]
      </span>
      <span style="float:right; margin=0 1em 0 1em;">
      <i>&copy; 2011&ndash;2019,
      Stan Development Team.
      &nbsp;&nbsp;&nbsp;&nbsp;
      </i>
      </span>
    </div> </li>
  </ul>
</div>
</body>
</html>
