<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stan Math Library: stan::math::integrate_1d</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="standoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<script type="text/javascript" src="eigen_navtree_hacks.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="stanlogo-main.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://mc-stan.org/math">Stan Math Library</a>
   &#160;<span id="projectnumber">5.0.0</span>
   </div>
   <div id="projectbrief">Automatic Differentiation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacestan_1_1math_ac1d9f775e895fe2e260e6c04a6b628d3.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="contents">
<a id="ac1d9f775e895fe2e260e6c04a6b628d3" name="ac1d9f775e895fe2e260e6c04a6b628d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1d9f775e895fe2e260e6c04a6b628d3">&#9670;&#160;</a></span>integrate_1d() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename F , typename T_a , typename T_b , typename T_theta , <a class="el" href="group__fvar__types_ga0acbafcf4967524342a974e6afed202a.html#ga0acbafcf4967524342a974e6afed202a">require_any_fvar_t</a>&lt; T_a, T_b, T_theta &gt; *  = nullptr&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type__trait_gacbaff683cd2683209e6855e2c7aaeffe.html#gacbaff683cd2683209e6855e2c7aaeffe">return_type_t</a>&lt; T_a, T_b, T_theta &gt; stan::math::integrate_1d </td>
          <td>(</td>
          <td class="paramtype">const F &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T_a &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T_b &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; T_theta &gt; &amp;&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream *&#160;</td>
          <td class="paramname"><em>msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>relative_tolerance</em> = <code>std::sqrt(<a class="el" href="namespacestan_1_1math_a28af31756798a98947ed5351b67fd9c4.html#a28af31756798a98947ed5351b67fd9c4">EPSILON</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the integral of the single variable function f from a to b to within a specified relative tolerance. </p>
<p>a and b can be finite or infinite.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T_a</td><td>type of first limit </td></tr>
    <tr><td class="paramname">T_b</td><td>type of second limit </td></tr>
    <tr><td class="paramname">T_theta</td><td>type of parameters </td></tr>
    <tr><td class="paramname">T</td><td>Type of f</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">f</td><td>the functor to integrate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">a</td><td>lower limit of integration </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">b</td><td>upper limit of integration </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">theta</td><td>additional parameters to be passed to f </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">x_r</td><td>additional data to be passed to f </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">x_i</td><td>additional integer data to be passed to f </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">msgs</td><td>the print stream for warning messages </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">relative_tolerance</td><td>relative tolerance passed to Boost quadrature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>numeric integral of function f</dd></dl>
<p>a and b can be finite or infinite.</p>
<p>f should be compatible with reverse mode autodiff and have the signature: var f(double x, double xc, const std::vector&lt;var&gt;&amp; theta,
    const std::vector&lt;double&gt;&amp; x_r, const std::vector&lt;int&gt; &amp;x_i,
std::ostream* msgs)</p>
<p>It should return the value of the function evaluated at x. Any errors should be printed to the msgs stream.</p>
<p>Integrals that cross zero are broken into two, and the separate integrals are each integrated to the given relative tolerance.</p>
<p>For integrals with finite limits, the xc argument is the distance to the nearest boundary. So for a &gt; 0, b &gt; 0, it will be a - x for x closer to a, and b - x for x closer to b. xc is computed in a way that avoids the precision loss of computing a - x or b - x manually. For integrals that cross zero, xc can take values a - x, -x, or b - x depending on which integration limit it is nearest.</p>
<p>If either limit is infinite, xc is set to NaN</p>
<p>The integration algorithm terminates when  </p><p class="formulaDsp">
\[
    \frac{{|I_{n + 1} - I_n|}}{{|I|_{n + 1}}} &lt; \text{relative tolerance}
  \]
</p>
<p> where \(I_{n}\) is the nth estimate of the integral and \(|I|_{n}\) is the nth estimate of the norm of the integral.</p>
<p>Integrals that cross zero are split into two. In this case, each integral is separately integrated to the given relative_tolerance.</p>
<p>Gradients of f that evaluate to NaN when the function evaluates to zero are set to zero themselves. This is due to the autodiff easily overflowing to NaN when evaluating gradients near the maximum and minimum floating point values (where the function should be zero anyway for the integral to exist)</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T_a</td><td>type of first limit </td></tr>
    <tr><td class="paramname">T_b</td><td>type of second limit </td></tr>
    <tr><td class="paramname">T_theta</td><td>type of parameters </td></tr>
    <tr><td class="paramname">T</td><td>Type of f</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">f</td><td>the functor to integrate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">a</td><td>lower limit of integration </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">b</td><td>upper limit of integration </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">theta</td><td>additional parameters to be passed to f </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">x_r</td><td>additional data to be passed to f </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">x_i</td><td>additional integer data to be passed to f </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">msgs</td><td>the print stream for warning messages </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">relative_tolerance</td><td>relative tolerance passed to Boost quadrature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>numeric integral of function f </dd></dl>

<p class="definition">Definition at line <a class="el" href="fwd_2functor_2integrate__1d_8hpp_source.html#l00091">91</a> of file <a class="el" href="fwd_2functor_2integrate__1d_8hpp_source.html">integrate_1d.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacestan.html">stan</a></li><li class="navelem"><a class="el" href="namespacestan_1_1math.html">math</a></li>
    <li class="footer">
    <div class="contents" style="font-size:100%;">
      <span style="float:left; margin=0 1em 0 1em;">
      &nbsp;&nbsp;&nbsp;&nbsp;
      [ <a href="http://mc-stan.org/">Stan Home Page</a> ]
      </span>
      <span style="float:right; margin=0 1em 0 1em;">
      <i>&copy; 2011&ndash;2019,
      Stan Development Team.
      &nbsp;&nbsp;&nbsp;&nbsp;
      </i>
      </span>
    </div> </li>
  </ul>
</div>
</body>
</html>
