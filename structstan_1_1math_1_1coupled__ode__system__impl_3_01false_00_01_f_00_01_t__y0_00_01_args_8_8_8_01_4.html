<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stan Math Library: stan::math::coupled_ode_system_impl&lt; false, F, T_y0, Args... &gt; Struct Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="standoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<script type="text/javascript" src="eigen_navtree_hacks.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="stanlogo-main.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://mc-stan.org/math">Stan Math Library</a>
   &#160;<span id="projectnumber">5.0.0</span>
   </div>
   <div id="projectbrief">Automatic Differentiation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">stan::math::coupled_ode_system_impl&lt; false, F, T_y0, Args... &gt; Struct Template Reference</div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename F, typename T_y0, typename... Args&gt;<br />
struct stan::math::coupled_ode_system_impl&lt; false, F, T_y0, Args... &gt;</div><p>The <code><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl.html">coupled_ode_system_impl</a></code> template specialization when the state or parameters are autodiff types. </p>
<p>This coupled ode system has N + (N + M) * N states where N is the size of the base ode system and M is the number of parameters.</p>
<p>For the coupled ode system, the first N states are the base system's states: \( \frac{d x_n}{dt} \).</p>
<p>The next N + M states correspond to the sensitivities of the initial conditions, then to the sensitivities of the parameters with respect to the to the first base system equation. Calling initial conditions \( y0 \) and parameters \( \theta \):</p>
<p class="formulaDsp">
\[
  \frac{d x_{N + n}}{dt}
    = \frac{d}{dt} \frac{\partial x_1}{\partial y0_n}
\]
</p>
<p class="formulaDsp">
\[
  \frac{d x_{N + N + m}}{dt}
    = \frac{d}{dt} \frac{\partial x_1}{\partial \theta_m}
\]
</p>
<p>The next N + M states correspond to the sensitivities of the initial conditions followed by the sensitivites of the parameters with respect to the second base system equation, and so on through the last base system equation.</p>
<p>Note: Calculating the sensitivity system requires the Jacobian of the base ODE RHS wrt to the parameters. The parameters are constant for successive calls to the exposed operator(). For this reason, the parameter vector theta is copied upon construction onto the nochain var autodiff tape which is used in the the nested autodiff performed in the operator() of this adaptor. Doing so reduces the size of the nested autodiff and speeds up autodiff. As a side effect, the parameters will remain on the nochain autodiff part of the autodiff tape being in use even after destruction of the given instance. Moreover, the adjoint zeroing for the nested system does not cover the theta parameter vector part of the nochain autodiff tape and is therefore set to zero separately.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">F</td><td>base ode system functor. Must provide <code> template&lt;typename T_y, typename... T_args&gt; operator()(double t, const Eigen::Matrix&lt;T_y, Eigen::Dynamic, 1&gt;&amp; y,
    std::ostream* msgs, const T_args&amp;... args)</code> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rev_2functor_2coupled__ode__system_8hpp_source.html#l00069">69</a> of file <a class="el" href="rev_2functor_2coupled__ode__system_8hpp_source.html">coupled_ode_system.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="rev_2functor_2coupled__ode__system_8hpp_source.html">coupled_ode_system.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4cf91732a8507794af51f747e67f6961"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_a4cf91732a8507794af51f747e67f6961.html#a4cf91732a8507794af51f747e67f6961">coupled_ode_system_impl</a> (const F &amp;f, const Eigen::Matrix&lt; T_y0, Eigen::Dynamic, 1 &gt; &amp;y0, std::ostream *msgs, const Args &amp;... args)</td></tr>
<tr class="memdesc:a4cf91732a8507794af51f747e67f6961"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a coupled ode system from the base system function, initial state of the base system, parameters, and a stream for messages.  <br /></td></tr>
<tr class="separator:a4cf91732a8507794af51f747e67f6961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1f283f70dcad97dcca5a87c6a22e893"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_af1f283f70dcad97dcca5a87c6a22e893.html#af1f283f70dcad97dcca5a87c6a22e893">operator()</a> (const std::vector&lt; double &gt; &amp;z, std::vector&lt; double &gt; &amp;dz_dt, double t)</td></tr>
<tr class="memdesc:af1f283f70dcad97dcca5a87c6a22e893"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the right hand side of the coupled ode system (the regular ode system with forward sensitivities).  <br /></td></tr>
<tr class="separator:af1f283f70dcad97dcca5a87c6a22e893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12623cab1637f07fb3b46e2577b7c0d8"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_a12623cab1637f07fb3b46e2577b7c0d8.html#a12623cab1637f07fb3b46e2577b7c0d8">size</a> () const</td></tr>
<tr class="memdesc:a12623cab1637f07fb3b46e2577b7c0d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the size of the coupled system.  <br /></td></tr>
<tr class="separator:a12623cab1637f07fb3b46e2577b7c0d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a317964fdec0e24f1cfd6d0496bce66d8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_a317964fdec0e24f1cfd6d0496bce66d8.html#a317964fdec0e24f1cfd6d0496bce66d8">initial_state</a> () const</td></tr>
<tr class="memdesc:a317964fdec0e24f1cfd6d0496bce66d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the initial state of the coupled system.  <br /></td></tr>
<tr class="separator:a317964fdec0e24f1cfd6d0496bce66d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:aed5bc974abf6a3bc62b2bd46c7a0eafa"><td class="memItemLeft" align="right" valign="top">const F &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_aed5bc974abf6a3bc62b2bd46c7a0eafa.html#aed5bc974abf6a3bc62b2bd46c7a0eafa">f_</a></td></tr>
<tr class="separator:aed5bc974abf6a3bc62b2bd46c7a0eafa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ee207007f512a6d066eea1a279bf19"><td class="memItemLeft" align="right" valign="top">const Eigen::Matrix&lt; T_y0, Eigen::Dynamic, 1 &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_a51ee207007f512a6d066eea1a279bf19.html#a51ee207007f512a6d066eea1a279bf19">y0_</a></td></tr>
<tr class="separator:a51ee207007f512a6d066eea1a279bf19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7fdbaceed8e6fccbb95c8ee73403a9f"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; decltype(<a class="el" href="namespacestan_1_1math_a70ff0e8a272893ba0a5e27511036f741.html#a70ff0e8a272893ba0a5e27511036f741">deep_copy_vars</a>(std::declval&lt; const Args &amp; &gt;()))... &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_aa7fdbaceed8e6fccbb95c8ee73403a9f.html#aa7fdbaceed8e6fccbb95c8ee73403a9f">local_args_tuple_</a></td></tr>
<tr class="separator:aa7fdbaceed8e6fccbb95c8ee73403a9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a672e481a33603abce7616b048002c2c2"><td class="memItemLeft" align="right" valign="top">const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_a672e481a33603abce7616b048002c2c2.html#a672e481a33603abce7616b048002c2c2">num_y0_vars_</a></td></tr>
<tr class="separator:a672e481a33603abce7616b048002c2c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac456f3141151137a9cdc50b57ff272ec"><td class="memItemLeft" align="right" valign="top">const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_ac456f3141151137a9cdc50b57ff272ec.html#ac456f3141151137a9cdc50b57ff272ec">num_args_vars</a></td></tr>
<tr class="separator:ac456f3141151137a9cdc50b57ff272ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d0b4b8077f5bcb3b6412034e4ba5c0a"><td class="memItemLeft" align="right" valign="top">const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_a9d0b4b8077f5bcb3b6412034e4ba5c0a.html#a9d0b4b8077f5bcb3b6412034e4ba5c0a">N_</a></td></tr>
<tr class="separator:a9d0b4b8077f5bcb3b6412034e4ba5c0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a019953fb0a38b81bb11a2185e64d4c6c"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_a019953fb0a38b81bb11a2185e64d4c6c.html#a019953fb0a38b81bb11a2185e64d4c6c">args_adjoints_</a></td></tr>
<tr class="separator:a019953fb0a38b81bb11a2185e64d4c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46fee263fc70c468290a8d845e7ed280"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_a46fee263fc70c468290a8d845e7ed280.html#a46fee263fc70c468290a8d845e7ed280">y_adjoints_</a></td></tr>
<tr class="separator:a46fee263fc70c468290a8d845e7ed280"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3070c1425b0eab530a502152ca6aaa8"><td class="memItemLeft" align="right" valign="top">std::ostream *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4_ac3070c1425b0eab530a502152ca6aaa8.html#ac3070c1425b0eab530a502152ca6aaa8">msgs_</a></td></tr>
<tr class="separator:ac3070c1425b0eab530a502152ca6aaa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>stan/math/rev/functor/<a class="el" href="rev_2functor_2coupled__ode__system_8hpp_source.html">coupled_ode_system.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacestan.html">stan</a></li><li class="navelem"><a class="el" href="namespacestan_1_1math.html">math</a></li><li class="navelem"><a class="el" href="structstan_1_1math_1_1coupled__ode__system__impl_3_01false_00_01_f_00_01_t__y0_00_01_args_8_8_8_01_4.html">coupled_ode_system_impl&lt; false, F, T_y0, Args... &gt;</a></li>
    <li class="footer">
    <div class="contents" style="font-size:100%;">
      <span style="float:left; margin=0 1em 0 1em;">
      &nbsp;&nbsp;&nbsp;&nbsp;
      [ <a href="http://mc-stan.org/">Stan Home Page</a> ]
      </span>
      <span style="float:right; margin=0 1em 0 1em;">
      <i>&copy; 2011&ndash;2019,
      Stan Development Team.
      &nbsp;&nbsp;&nbsp;&nbsp;
      </i>
      </span>
    </div> </li>
  </ul>
</div>
</body>
</html>
